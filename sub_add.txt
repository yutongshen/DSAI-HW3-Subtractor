Train on 18000 samples, validate on 2000 samples
Epoch 1/100
2018-05-13 18:35:51.327079: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
18000/18000 [==============================] - 14s 764us/step - loss: 1.6767 - acc: 0.4052 - val_loss: 1.5652 - val_acc: 0.4274
Epoch 2/100
18000/18000 [==============================] - 10s 578us/step - loss: 1.4066 - acc: 0.4839 - val_loss: 1.3797 - val_acc: 0.4844
Epoch 3/100
18000/18000 [==============================] - 10s 576us/step - loss: 1.2204 - acc: 0.5442 - val_loss: 1.1883 - val_acc: 0.5506
Epoch 4/100
18000/18000 [==============================] - 10s 573us/step - loss: 1.0521 - acc: 0.6044 - val_loss: 1.0812 - val_acc: 0.5934
Epoch 5/100
18000/18000 [==============================] - 10s 576us/step - loss: 0.9400 - acc: 0.6464 - val_loss: 0.9758 - val_acc: 0.6304
Epoch 6/100
18000/18000 [==============================] - 10s 572us/step - loss: 0.8458 - acc: 0.6826 - val_loss: 0.8966 - val_acc: 0.6571
Epoch 7/100
18000/18000 [==============================] - 10s 578us/step - loss: 0.7495 - acc: 0.7195 - val_loss: 0.7955 - val_acc: 0.7022
Epoch 8/100
18000/18000 [==============================] - 10s 575us/step - loss: 0.6391 - acc: 0.7610 - val_loss: 0.6966 - val_acc: 0.7298
Epoch 9/100
18000/18000 [==============================] - 10s 576us/step - loss: 0.5225 - acc: 0.8066 - val_loss: 0.5822 - val_acc: 0.7816
Epoch 10/100
18000/18000 [==============================] - 10s 575us/step - loss: 0.4117 - acc: 0.8522 - val_loss: 0.5137 - val_acc: 0.8013
Epoch 11/100
18000/18000 [==============================] - 10s 574us/step - loss: 0.3197 - acc: 0.8912 - val_loss: 0.3867 - val_acc: 0.8541
Epoch 12/100
18000/18000 [==============================] - 10s 580us/step - loss: 0.2463 - acc: 0.9196 - val_loss: 0.3217 - val_acc: 0.8867
Epoch 13/100
18000/18000 [==============================] - 10s 577us/step - loss: 0.1942 - acc: 0.9396 - val_loss: 0.2922 - val_acc: 0.8971
Epoch 14/100
18000/18000 [==============================] - 10s 576us/step - loss: 0.1651 - acc: 0.9491 - val_loss: 0.2732 - val_acc: 0.9002
Epoch 15/100
18000/18000 [==============================] - 10s 573us/step - loss: 0.1526 - acc: 0.9521 - val_loss: 0.2322 - val_acc: 0.9173
Epoch 16/100
18000/18000 [==============================] - 10s 576us/step - loss: 0.1079 - acc: 0.9706 - val_loss: 0.2378 - val_acc: 0.9130
Epoch 17/100
18000/18000 [==============================] - 10s 578us/step - loss: 0.0814 - acc: 0.9798 - val_loss: 0.1710 - val_acc: 0.9420
Epoch 18/100
18000/18000 [==============================] - 10s 580us/step - loss: 0.0560 - acc: 0.9884 - val_loss: 0.1528 - val_acc: 0.9447
Epoch 19/100
18000/18000 [==============================] - 10s 582us/step - loss: 0.0455 - acc: 0.9912 - val_loss: 0.1445 - val_acc: 0.9530
Epoch 20/100
18000/18000 [==============================] - 10s 580us/step - loss: 0.1031 - acc: 0.9674 - val_loss: 0.1919 - val_acc: 0.9289
Epoch 21/100
18000/18000 [==============================] - 10s 576us/step - loss: 0.0493 - acc: 0.9889 - val_loss: 0.1342 - val_acc: 0.9539
Epoch 22/100
18000/18000 [==============================] - 10s 576us/step - loss: 0.0411 - acc: 0.9905 - val_loss: 0.1645 - val_acc: 0.9431
Epoch 23/100
18000/18000 [==============================] - 10s 581us/step - loss: 0.0595 - acc: 0.9837 - val_loss: 0.1501 - val_acc: 0.9477
Epoch 24/100
18000/18000 [==============================] - 10s 578us/step - loss: 0.0397 - acc: 0.9914 - val_loss: 0.1420 - val_acc: 0.9502
Epoch 25/100
18000/18000 [==============================] - 11s 583us/step - loss: 0.0291 - acc: 0.9940 - val_loss: 0.1575 - val_acc: 0.9450
Epoch 26/100
18000/18000 [==============================] - 10s 583us/step - loss: 0.0271 - acc: 0.9950 - val_loss: 0.1170 - val_acc: 0.9575
Epoch 27/100
18000/18000 [==============================] - 11s 585us/step - loss: 0.0123 - acc: 0.9991 - val_loss: 0.0978 - val_acc: 0.9657
Epoch 28/100
18000/18000 [==============================] - 10s 580us/step - loss: 0.0070 - acc: 0.9999 - val_loss: 0.0967 - val_acc: 0.9660
Epoch 29/100
18000/18000 [==============================] - 10s 578us/step - loss: 0.0056 - acc: 1.0000 - val_loss: 0.0996 - val_acc: 0.9655
Epoch 30/100
18000/18000 [==============================] - 10s 579us/step - loss: 0.0047 - acc: 1.0000 - val_loss: 0.0981 - val_acc: 0.9657
Epoch 31/100
18000/18000 [==============================] - 10s 581us/step - loss: 0.0039 - acc: 1.0000 - val_loss: 0.1003 - val_acc: 0.9659
Epoch 32/100
18000/18000 [==============================] - 10s 579us/step - loss: 0.0033 - acc: 1.0000 - val_loss: 0.1001 - val_acc: 0.9659
Epoch 33/100
18000/18000 [==============================] - 10s 580us/step - loss: 0.0028 - acc: 1.0000 - val_loss: 0.0998 - val_acc: 0.9667
Epoch 34/100
18000/18000 [==============================] - 10s 577us/step - loss: 0.0025 - acc: 1.0000 - val_loss: 0.1000 - val_acc: 0.9667
Epoch 35/100
18000/18000 [==============================] - 10s 575us/step - loss: 0.0022 - acc: 0.9999 - val_loss: 0.1023 - val_acc: 0.9665
Epoch 36/100
18000/18000 [==============================] - 10s 580us/step - loss: 0.0021 - acc: 0.9999 - val_loss: 0.1076 - val_acc: 0.9650
Epoch 37/100
18000/18000 [==============================] - 10s 583us/step - loss: 0.2071 - acc: 0.9340 - val_loss: 0.2056 - val_acc: 0.9266
Epoch 38/100
18000/18000 [==============================] - 10s 579us/step - loss: 0.0541 - acc: 0.9843 - val_loss: 0.1652 - val_acc: 0.9441
Epoch 39/100
18000/18000 [==============================] - 10s 580us/step - loss: 0.0293 - acc: 0.9929 - val_loss: 0.1342 - val_acc: 0.9544
Epoch 40/100
18000/18000 [==============================] - 10s 580us/step - loss: 0.0106 - acc: 0.9987 - val_loss: 0.1134 - val_acc: 0.9604
Epoch 41/100
18000/18000 [==============================] - 10s 576us/step - loss: 0.0077 - acc: 0.9990 - val_loss: 0.1326 - val_acc: 0.9542
Epoch 42/100
18000/18000 [==============================] - 10s 573us/step - loss: 0.0325 - acc: 0.9907 - val_loss: 0.2016 - val_acc: 0.9354
Epoch 43/100
18000/18000 [==============================] - 10s 576us/step - loss: 0.0377 - acc: 0.9883 - val_loss: 0.1307 - val_acc: 0.9552
Epoch 44/100
18000/18000 [==============================] - 10s 574us/step - loss: 0.0115 - acc: 0.9978 - val_loss: 0.1225 - val_acc: 0.9574
Epoch 45/100
18000/18000 [==============================] - 10s 575us/step - loss: 0.0047 - acc: 0.9995 - val_loss: 0.1035 - val_acc: 0.9646
Epoch 46/100
18000/18000 [==============================] - 10s 575us/step - loss: 0.0020 - acc: 1.0000 - val_loss: 0.0990 - val_acc: 0.9662
Epoch 47/100
18000/18000 [==============================] - 10s 576us/step - loss: 0.0016 - acc: 1.0000 - val_loss: 0.0995 - val_acc: 0.9664
Epoch 48/100
18000/18000 [==============================] - 10s 575us/step - loss: 0.0014 - acc: 1.0000 - val_loss: 0.0996 - val_acc: 0.9664
Epoch 49/100
18000/18000 [==============================] - 10s 573us/step - loss: 0.0012 - acc: 1.0000 - val_loss: 0.0994 - val_acc: 0.9670
Epoch 50/100
18000/18000 [==============================] - 10s 572us/step - loss: 0.0010 - acc: 1.0000 - val_loss: 0.0998 - val_acc: 0.9665
Epoch 51/100
18000/18000 [==============================] - 10s 569us/step - loss: 9.2061e-04 - acc: 1.0000 - val_loss: 0.1006 - val_acc: 0.9671
Epoch 52/100
18000/18000 [==============================] - 10s 566us/step - loss: 8.2280e-04 - acc: 1.0000 - val_loss: 0.1013 - val_acc: 0.9671
Epoch 53/100
18000/18000 [==============================] - 10s 569us/step - loss: 7.3824e-04 - acc: 1.0000 - val_loss: 0.1017 - val_acc: 0.9669
Epoch 54/100
18000/18000 [==============================] - 10s 568us/step - loss: 6.6562e-04 - acc: 1.0000 - val_loss: 0.1030 - val_acc: 0.9671
Epoch 55/100
18000/18000 [==============================] - 10s 565us/step - loss: 6.0237e-04 - acc: 1.0000 - val_loss: 0.1026 - val_acc: 0.9677
Epoch 56/100
18000/18000 [==============================] - 10s 569us/step - loss: 5.4248e-04 - acc: 1.0000 - val_loss: 0.1027 - val_acc: 0.9681
Epoch 57/100
18000/18000 [==============================] - 10s 569us/step - loss: 4.9411e-04 - acc: 1.0000 - val_loss: 0.1044 - val_acc: 0.9676
Epoch 58/100
18000/18000 [==============================] - 10s 573us/step - loss: 4.4576e-04 - acc: 1.0000 - val_loss: 0.1046 - val_acc: 0.9677
Epoch 59/100
18000/18000 [==============================] - 10s 570us/step - loss: 4.0497e-04 - acc: 1.0000 - val_loss: 0.1057 - val_acc: 0.9676
Epoch 60/100
18000/18000 [==============================] - 10s 572us/step - loss: 3.6739e-04 - acc: 1.0000 - val_loss: 0.1065 - val_acc: 0.9679
Epoch 61/100
18000/18000 [==============================] - 10s 572us/step - loss: 3.3397e-04 - acc: 1.0000 - val_loss: 0.1070 - val_acc: 0.9680
Epoch 62/100
18000/18000 [==============================] - 10s 575us/step - loss: 3.0437e-04 - acc: 1.0000 - val_loss: 0.1079 - val_acc: 0.9679
Epoch 63/100
18000/18000 [==============================] - 10s 572us/step - loss: 2.8050e-04 - acc: 1.0000 - val_loss: 0.1083 - val_acc: 0.9682
Epoch 64/100
18000/18000 [==============================] - 10s 569us/step - loss: 0.2150 - acc: 0.9363 - val_loss: 0.2842 - val_acc: 0.9053
Epoch 65/100
18000/18000 [==============================] - 10s 568us/step - loss: 0.0500 - acc: 0.9845 - val_loss: 0.1403 - val_acc: 0.9546
Epoch 66/100
18000/18000 [==============================] - 10s 566us/step - loss: 0.0093 - acc: 0.9990 - val_loss: 0.1121 - val_acc: 0.9614
Epoch 67/100
18000/18000 [==============================] - 10s 566us/step - loss: 0.0033 - acc: 0.9999 - val_loss: 0.1030 - val_acc: 0.9661
Epoch 68/100
18000/18000 [==============================] - 10s 571us/step - loss: 0.0022 - acc: 1.0000 - val_loss: 0.1010 - val_acc: 0.9670
Epoch 69/100
18000/18000 [==============================] - 10s 572us/step - loss: 0.0016 - acc: 1.0000 - val_loss: 0.1000 - val_acc: 0.9675
Epoch 70/100
18000/18000 [==============================] - 10s 574us/step - loss: 0.0014 - acc: 1.0000 - val_loss: 0.0998 - val_acc: 0.9675
Epoch 71/100
18000/18000 [==============================] - 10s 571us/step - loss: 0.0011 - acc: 1.0000 - val_loss: 0.1001 - val_acc: 0.9683
Epoch 72/100
18000/18000 [==============================] - 10s 573us/step - loss: 9.8723e-04 - acc: 1.0000 - val_loss: 0.0998 - val_acc: 0.9679
Epoch 73/100
18000/18000 [==============================] - 10s 570us/step - loss: 8.6150e-04 - acc: 1.0000 - val_loss: 0.1004 - val_acc: 0.9680
Epoch 74/100
18000/18000 [==============================] - 10s 572us/step - loss: 7.5717e-04 - acc: 1.0000 - val_loss: 0.1003 - val_acc: 0.9679
Epoch 75/100
18000/18000 [==============================] - 10s 572us/step - loss: 6.7057e-04 - acc: 1.0000 - val_loss: 0.1003 - val_acc: 0.9683
Epoch 76/100
18000/18000 [==============================] - 10s 572us/step - loss: 5.9697e-04 - acc: 1.0000 - val_loss: 0.1008 - val_acc: 0.9683
Epoch 77/100
18000/18000 [==============================] - 10s 571us/step - loss: 5.3390e-04 - acc: 1.0000 - val_loss: 0.1018 - val_acc: 0.9683
Epoch 78/100
18000/18000 [==============================] - 10s 575us/step - loss: 4.7924e-04 - acc: 1.0000 - val_loss: 0.1019 - val_acc: 0.9681
Epoch 79/100
18000/18000 [==============================] - 10s 574us/step - loss: 4.3127e-04 - acc: 1.0000 - val_loss: 0.1021 - val_acc: 0.9678
Epoch 80/100
18000/18000 [==============================] - 10s 572us/step - loss: 3.8954e-04 - acc: 1.0000 - val_loss: 0.1026 - val_acc: 0.9675
Epoch 81/100
18000/18000 [==============================] - 10s 571us/step - loss: 3.5192e-04 - acc: 1.0000 - val_loss: 0.1035 - val_acc: 0.9675
Epoch 82/100
18000/18000 [==============================] - 10s 570us/step - loss: 3.1887e-04 - acc: 1.0000 - val_loss: 0.1041 - val_acc: 0.9679
Epoch 83/100
18000/18000 [==============================] - 10s 567us/step - loss: 2.8909e-04 - acc: 1.0000 - val_loss: 0.1043 - val_acc: 0.9681
Epoch 84/100
18000/18000 [==============================] - 10s 566us/step - loss: 2.6287e-04 - acc: 1.0000 - val_loss: 0.1049 - val_acc: 0.9682
Epoch 85/100
18000/18000 [==============================] - 10s 570us/step - loss: 2.3860e-04 - acc: 1.0000 - val_loss: 0.1054 - val_acc: 0.9681
Epoch 86/100
18000/18000 [==============================] - 10s 569us/step - loss: 2.1726e-04 - acc: 1.0000 - val_loss: 0.1059 - val_acc: 0.9685
Epoch 87/100
18000/18000 [==============================] - 10s 569us/step - loss: 1.9770e-04 - acc: 1.0000 - val_loss: 0.1061 - val_acc: 0.9692
Epoch 88/100
18000/18000 [==============================] - 10s 570us/step - loss: 1.8021e-04 - acc: 1.0000 - val_loss: 0.1070 - val_acc: 0.9699
Epoch 89/100
18000/18000 [==============================] - 10s 572us/step - loss: 1.6422e-04 - acc: 1.0000 - val_loss: 0.1075 - val_acc: 0.9695
Epoch 90/100
18000/18000 [==============================] - 10s 570us/step - loss: 1.4953e-04 - acc: 1.0000 - val_loss: 0.1081 - val_acc: 0.9699
Epoch 91/100
18000/18000 [==============================] - 10s 571us/step - loss: 1.3660e-04 - acc: 1.0000 - val_loss: 0.1090 - val_acc: 0.9689
Epoch 92/100
18000/18000 [==============================] - 10s 571us/step - loss: 1.2473e-04 - acc: 1.0000 - val_loss: 0.1085 - val_acc: 0.9694
Epoch 93/100
18000/18000 [==============================] - 10s 572us/step - loss: 1.1370e-04 - acc: 1.0000 - val_loss: 0.1093 - val_acc: 0.9696
Epoch 94/100
18000/18000 [==============================] - 10s 571us/step - loss: 1.0389e-04 - acc: 1.0000 - val_loss: 0.1103 - val_acc: 0.9704
Epoch 95/100
18000/18000 [==============================] - 10s 570us/step - loss: 9.4763e-05 - acc: 1.0000 - val_loss: 0.1115 - val_acc: 0.9700
Epoch 96/100
18000/18000 [==============================] - 10s 576us/step - loss: 8.6495e-05 - acc: 1.0000 - val_loss: 0.1122 - val_acc: 0.9697
Epoch 97/100
18000/18000 [==============================] - 10s 573us/step - loss: 7.8922e-05 - acc: 1.0000 - val_loss: 0.1120 - val_acc: 0.9697
Epoch 98/100
18000/18000 [==============================] - 10s 573us/step - loss: 7.2159e-05 - acc: 1.0000 - val_loss: 0.1127 - val_acc: 0.9697
Epoch 99/100
18000/18000 [==============================] - 10s 573us/step - loss: 6.5853e-05 - acc: 1.0000 - val_loss: 0.1132 - val_acc: 0.9697
Epoch 100/100
18000/18000 [==============================] - 10s 575us/step - loss: 6.0075e-05 - acc: 1.0000 - val_loss: 0.1146 - val_acc: 0.9702